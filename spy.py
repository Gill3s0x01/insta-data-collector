import instaloader
from datetime import datetime
import os

ascii_art = """
_______________________¶¶¶______________________
_____________________¶¶¶¶¶¶¶¶¶¶¶¶_________________
___________________¶¶¶_________¶¶¶________________
__________________¶¶_____________¶¶_______________
_________________¶¶________________¶______________
________________¶¶_________________¶¶_____________
________________¶__________________¶¶_____________
_______________¶¶___________________¶_____________
_______________¶¶___________________¶¶____________
_______________¶_¶¶_________________¶¶____________
_______________¶_¶¶_________________¶¶____________
_______________¶¶¶__________________¶_____________
___¶___________¶¶¶__________________¶_____________
___¶¶__________¶¶¶___¶¶¶¶____¶¶¶____¶___________¶¶
___¶¶__________¶¶¶__¶¶__¶¶__¶¶¶¶¶___¶¶__________¶¶
___¶¶¶_________¶¶¶_¶¶____¶__¶___¶¶_¶¶¶__________¶_
____¶¶_________¶¶¶_¶___¶¶¶__¶¶___¶_¶¶__________¶¶_
____¶¶¶_________¶__¶¶¶¶¶__¶__¶¶¶¶¶_¶__________¶¶¶_
____¶¶¶¶_______¶____¶¶¶__¶¶____¶¶¶_¶¶¶________¶¶¶_
_____¶_¶______¶¶¶_______¶¶¶¶________¶¶_______¶¶¶__
_____¶¶¶¶_______¶¶¶_____¶__¶_______¶¶_______¶¶¶¶__
______¶_¶¶________¶¶¶___¶__¶¶____¶¶¶________¶_¶___
_______¶_¶¶_____¶¶__¶___¶_¶¶¶___¶¶_________¶_¶____
_______¶¶_¶_____¶¶¶¶¶¶__¶¶¶¶¶__¶¶¶¶_______¶_¶¶____
________¶¶¶¶_____¶_¶¶¶__¶¶_¶___¶¶¶¶______¶¶_¶_____
_________¶_¶¶_____¶_¶¶¶_______¶¶¶¶______¶¶_¶______
__________¶_¶¶____¶¶¶_¶¶¶¶¶¶¶¶¶¶¶¶______¶_¶_______
___________¶_¶¶____¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶_____¶¶¶¶_______
____________¶_¶¶____¶¶_________¶¶¶___¶¶_¶¶________
_____________¶_¶¶¶__¶¶¶¶¶¶_¶¶¶¶¶¶___¶¶_¶¶_________
______________¶¶_¶¶_¶¶¶¶¶¶¶¶¶¶¶¶¶__¶¶_¶¶__________
_______________¶¶_¶¶_¶_¶¶¶¶¶¶__¶_¶¶__¶¶___________
________________¶¶_¶¶_¶_______¶¶¶¶__¶_____________
_________________¶¶_¶¶¶¶¶¶¶¶¶¶¶¶__¶¶______________
________¶¶________¶¶_¶¶¶_¶¶¶¶¶___¶¶_______________
_______¶¶¶¶_________¶__¶¶__¶____¶¶________________
________¶¶¶¶_______¶_¶¶_¶¶¶¶¶¶¶¶__________¶¶______
_¶¶¶_____¶¶¶¶_¶¶¶¶¶¶¶_¶¶__¶¶¶¶¶_________¶¶¶¶¶_____
¶__¶¶¶¶¶__¶¶_¶¶¶¶____¶¶¶¶¶__¶¶¶¶¶______¶¶__¶______
¶__¶¶_¶¶¶¶¶¶¶_¶¶¶__¶¶¶¶__¶¶¶___¶¶¶¶¶__¶¶_¶¶_____¶¶
¶¶¶¶¶¶_____¶¶_¶¶¶¶¶¶¶______¶¶¶____¶¶¶¶¶¶¶¶_____¶¶¶
__¶__¶¶¶¶¶¶¶¶_¶______________¶¶¶¶¶¶¶¶_¶¶¶¶¶¶¶¶¶¶¶_
_____________¶¶¶________________¶¶¶¶¶_¶¶______¶¶¶¶
_____________¶¶¶¶¶¶________________¶¶¶¶¶¶¶¶¶¶¶¶___
______________¶¶¶¶¶____________¶¶¶¶¶_¶____________
_______________________________¶¶__¶¶_____________
"""


def buscar_dados_instagram(username):
    L = instaloader.Instaloader()

    try:
        profile = instaloader.Profile.from_username(L.context, username)

        dados = {
            "User ID": profile.userid,
            "Username": profile.username,
            "Full Name": profile.full_name,
            "Bio": profile.biography,
            "External URL": profile.external_url,
            "Is Verified": profile.is_verified,
            "Is Private": profile.is_private,
            "Followers": profile.followers,
            "Followees": profile.followees,
            "Number of Posts": profile.mediacount,
            "Profile Picture URL": profile.profile_pic_url,
            "Email": "Not available via public API",
            "Phone": "Not available via public API",
        }

        return dados

    except Exception as e:
        return {"Error": str(e)}


def salvar_em_txt(username, dados):
    # Cria pasta 'results' se não existir
    if not os.path.exists("results"):
        os.makedirs("results")

    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    filename = f"results/{username}_{timestamp}.txt"

    with open(filename, "w", encoding="utf-8") as f:
        f.write(ascii_art + "\n\n")
        f.write(f"Instagram Profile Data for: {username}\n\n")
        for chave, valor in dados.items():
            f.write(f"{chave}: {valor}\n")

    print(f"\nData saved to file: {filename}")


if __name__ == "__main__":
    print(ascii_art)

    username = input("Enter the Instagram profile username you want to fetch: ").strip()
    dados = buscar_dados_instagram(username)

    print("\nInstagram Profile Data:\n")
    for chave, valor in dados.items():
        print(f"{chave}: {valor}")

    salvar_em_txt(username, dados)
